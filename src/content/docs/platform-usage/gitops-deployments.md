---
title: GitOps Deployments
description: Automate deployments with GitOps workflows
---

# GitOps Deployments

Edka uses GitOps principles to automate application deployments. This approach treats Git as the single source of truth for your infrastructure and applications.

## How GitOps Works in Edka

1. You define your application configuration in a Git repository
2. Edka monitors the repository for changes
3. When changes are detected, Edka automatically:
   - Builds container images
   - Updates deployments in your cluster
   - Creates preview environments for pull requests

## Setting Up GitOps

### Prerequisites

- A GitHub repository containing your application code and Kubernetes manifests
- A container registry (GitHub Container Registry, Docker Hub, etc.)

### Connect Your Repository

1. In the Edka dashboard, navigate to your cluster
2. Click on the **GitOps** tab
3. Click **Connect Repository**
4. Authorize Edka to access your GitHub account
5. Select the repository you want to connect
6. Configure repository settings:
   - **Default Branch**: The branch to monitor for production deployments (usually `main` or `master`)
   - **Path**: Directory containing Kubernetes manifests (default: `./k8s`)
   - **Sync Interval**: How often to check for changes (default: 1 minute)

### Repository Structure

Edka expects a certain structure in your repository:

```
repository/
├── Dockerfile              # Build instructions for your application
├── .github/workflows/      # CI pipeline (optional, Edka can generate this)
└── k8s/                    # Kubernetes manifests
    ├── base/               # Base configuration
    │   ├── deployment.yaml
    │   ├── service.yaml
    │   └── kustomization.yaml
    ├── overlays/           # Environment-specific configurations
    │   ├── production/
    │   │   └── kustomization.yaml
    │   └── staging/
    │       └── kustomization.yaml
    └── flux-system/        # Flux configuration (generated by Edka)
```

If your repository doesn't match this structure, Edka can help you set it up during the connection process.

## Continuous Deployment

Once your repository is connected, Edka sets up continuous deployment:

### Production Deployments

1. Changes pushed to your default branch trigger a CI pipeline
2. The pipeline builds and tags a container image
3. The image is pushed to your container registry
4. Flux detects the new image and updates your cluster

### Preview Environments

For pull requests:

1. When a PR is opened, Edka creates a preview environment
2. The environment gets a unique URL (e.g., `pr-42.your-app.edka.io`)
3. As changes are pushed to the PR, the preview is automatically updated
4. When the PR is closed, the preview environment is cleaned up

## Monitoring Deployments

The **GitOps** tab in your cluster dashboard shows:

- **Current State**: What's currently deployed in your cluster
- **Deployment History**: Recent deployments and their status
- **Sync Status**: Whether your cluster matches the desired state in Git
- **Active Preview Environments**: List of PR-based preview environments

## Advanced GitOps Features

### Multi-App Deployments

You can connect multiple repositories to a single cluster for more complex applications:

1. Navigate to **GitOps** > **Repositories**
2. Click **Connect Repository** to add additional repositories
3. Configure namespace and deployment settings for each repository

### Manual Promotion

For more controlled deployments:

1. Enable **Manual Promotion** in your repository settings
2. New images will be built but not automatically deployed
3. Use the **Promote** button in the dashboard to deploy specific versions

### Custom CI/CD Integration

If you have an existing CI/CD pipeline:

1. Configure your pipeline to build and push images
2. Edka's Flux operator will detect new images and update deployments
3. Alternatively, your pipeline can update manifests and commit them to the repository

## Troubleshooting

Common GitOps issues and how to resolve them:

### Deployments Not Updating

- Check that your image tag policy is correctly configured
- Verify that your CI pipeline successfully pushed the new image
- Check Flux logs for synchronization errors

### Preview Environments Not Creating

- Ensure your GitHub permissions are correctly set
- Check that your base kustomization includes necessary resources
- Verify that preview namespace creation is enabled

### Reconciliation Failures

1. Check the error message in the GitOps dashboard
2. Verify your Kubernetes manifests for syntax errors
3. Check resource constraints (you might be hitting quota limits)
4. Review the Flux controller logs for detailed error information 